# Health care
This is a health care assistant that can help user to manage their health data and chat with them. and also bind with their companion to monitor their health status.

## Tech Stack

### Frontend
![React](https://img.shields.io/badge/-React-61DAFB?logo=react&logoColor=white&style=flat)
![Node.js](https://img.shields.io/badge/-Node.js-339933?logo=node.js&logoColor=white&style=flat)
![Tailwind CSS](https://img.shields.io/badge/-Tailwind%20CSS-38B2AC?logo=tailwind-css&logoColor=white&style=flat)

### Backend
![Spring Boot](https://img.shields.io/badge/-Spring%20Boot-6DB33F?logo=spring-boot&logoColor=white&style=flat)

### Message Queue
![RabbitMQ](https://img.shields.io/badge/-RabbitMQ-FF6600?logo=rabbitmq&logoColor=white&style=flat)

### Communication Protocol
![WebSocket](https://img.shields.io/badge/-WebSocket-4A90E2?logo=websocket&logoColor=white&style=flat)
![RESTful API](https://img.shields.io/badge/-RESTful-000000?logo=api&logoColor=white&style=flat)

### External API
![OpenAI API](https://img.shields.io/badge/-OpenAI-412991?logo=openai&logoColor=white&style=flat)
![Google Maps API](https://img.shields.io/badge/-Google%20Maps-4285F4?logo=google-maps&logoColor=white&style=flat)


### Database
![ChromaDB](https://img.shields.io/badge/-ChromaDB-4A90E2?style=flat)
![H2 (Embedded)](https://img.shields.io/badge/-H2%20Database-4479A1?style=flat)
![Elasticsearch](https://img.shields.io/badge/-Elasticsearch-005571?logo=elasticsearch&logoColor=white&style=flat)
![Redis](https://img.shields.io/badge/-Redis-DC382D?logo=redis&logoColor=white&style=flat)
![PocketBase](https://img.shields.io/badge/-PocketBase-4A90E2?style=flat)

## Architecture
RESTful API and event-driven architecture

## Features
### AI-driven functionalities
###  **Agents Cluster with Multi-Functionality**

A cluster of three multi-functional agents—**RecordRetriever** and **WeatherAnalyzer**—integrated with a chatbot, operates using a **three-level decision tree** for autonomous function selection based on user prompts. Here’s an overview of the decision-making flow:

- **Level 1: Agent Selection**  
  The chatbot initially selects the relevant agent based on the type of user query. Each agent (e.g., WeatherAnalyzer, RecordRetriever) is chosen according to its defined capabilities.

- **Level 2: Function Selection within Agent**  
  The chosen agent then identifies the specific function based on the user’s prompt. For example, if WeatherAnalyzer is activated, it will determine if the request is related to weather data, weather forecast, or historical weather data.

- **Level 3: Response Verification and Optimization**  
  The response generated by the agent is verified to ensure it aligns with the user’s query. If necessary, further optimizations are applied to refine the output.



### **Personal GP Agent**

The **Personal GP Agent** is a real-time monitoring tool designed to detect suspicious activities in uploaded transactions. It leverages **RabbitMQ** for message queuing, **WebSocket** for real-time alerts, and **Spring AI** for behavior analysis, providing efficient, real-time processing.

- **Implementation Logic**  
  This agent functions through an **event-driven** approach. When a client submits a transaction via a **POST request**, the system asynchronously sends the transaction data through **RabbitMQ** to the analysis agent. The agent reviews transaction history from the last 10 days as context, evaluating the current transaction using pre-configured behavioral models in **Spring AI**.

- **Suspicious Activity Detection**  
  If suspicious behavior is identified, the agent generates a **warning message** (prefixed with “WARNING”) and sends it instantly to the frontend via **WebSocket**. The frontend then decides how to manage these warnings, ensuring flexible handling.



### **Chatbot with RAG and Context Memory**

This **chatbot component** integrates **Spring AI** with the **Chroma Vector Database** to provide an advanced conversational experience, enhanced by **Retrieval-Augmented Generation (RAG)** and contextual memory.

- **File Vectorization and Storage**  
  Uploaded files are automatically vectorized and stored in the **vector database**, enabling efficient retrieval and knowledge augmentation during conversations.

- **RAG-Enhanced Responses**  
  When RAG is enabled in a client request, the chatbot utilizes the vectorized content to generate enriched, knowledge-based responses.

- **Context Memory Management**  
  The system employs **ChatMemory** and **MessageChatMemoryAdvisor** to maintain context, using unique **conversationIds** for each chat session. This ensures isolated context and chat memories for separate conversation threads.


### **Highly Customized Personal Finance Report**

This feature includes a standalone interface that retrieves up to the **20 most recent health records** from the user’s database records. Through a **highly customized prompt manager**, these transactions are converted into a detailed prompt for the **LLM** (Large Language Model). The LLM then references stored documents in the **vector database** as context to generate a personalized, recent **health status report** for the user.




### Other functionalities
- Chat History: Support user to view their chat history

### Performance
- Use Redis to cache frequently accessed data
- Use async processing to improve performance

### Scalability
- Low coupling and high reusability code.

### Security
- User authentication and authorization by using Spring Security 6(integrated with JWT)


### User Experience
- Responsive design by using Tailwind CSS
- event-driven architecture for smooth user experience by using WebSocket and RabbitMQ
- Intuitive UI/UX
- Google map API for location-based service
- Real-time Stock Price driven by AlphaVantage API

### Basic CRUD
- User management
- Transaction management
- File management
- Chat history management

### Future Work
- Implement a mobile application
- Implement a distributed storage system on TiDB
- Chatbot memory management

## Let's Get Started! (Currently support MacOS and linux)
### 1. Clone the repository
```bash
git clone https://github.com/CSUYSD/Chronic-Disease-Management-Assistant.git
```

### 2. Install dependencies and start services
```bash
cd Anti-Scam-Financial-Management-Assistant/Backend
./setup.sh
cd ../client
npm install
```

### 3. Configure environment variables
3.1 API keys
Put your api key in the following format in IDEA run configuration
OPENAI_API_KEY="your openai api key"
WEATHER_API_KEY="your weather api key"
![IntelliJ IDEA environment configuration](image.png)

### 6. Start the application
```bash
./scripts/startbydocker.sh
```